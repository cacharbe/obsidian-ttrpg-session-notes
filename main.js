/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => CreateSessionPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// CreateSessionModal.ts
var import_obsidian = require("obsidian");
var CreateSessionModal = class extends import_obsidian.Modal {
  constructor(app2, plugin) {
    super(app2);
    this.plugin = plugin;
  }
  createInputDiv(form, labelText, inputType = "text") {
    const div = form.createEl("div");
    div.style.marginBottom = "10px";
    div.createEl("label", { text: labelText });
    const input = div.createEl("input");
    input.type = inputType;
    return input;
  }
  onOpen() {
    const { contentEl } = this;
    const form = contentEl.createEl("form");
    const campaignDiv = form.createEl("div");
    campaignDiv.style.marginBottom = "10px";
    campaignDiv.createEl("label", { text: "Campaign: " });
    const campaignSelect = campaignDiv.createEl("select");
    const selectCampaignOption = campaignSelect.createEl("option");
    selectCampaignOption.value = "";
    selectCampaignOption.text = "SELECT CAMPAIGN";
    selectCampaignOption.selected = true;
    selectCampaignOption.disabled = true;
    const sessionNumInput = this.createInputDiv(form, "Session Number: ");
    const sessionTitleInput = this.createInputDiv(form, "Session Title: ");
    const worldInput = this.createInputDiv(form, "World: ");
    const threadInput = this.createInputDiv(form, "Thread: ");
    const chapterInput = this.createInputDiv(form, "Chapter: ");
    const locationInput = this.createInputDiv(form, "Location: ");
    const fcDateInput = this.createInputDiv(form, "Fc-date: ");
    const fcCategoryInput = this.createInputDiv(form, "Fc-category: ");
    const ttrpgsFolder = this.app.vault.getAbstractFileByPath(this.plugin.settings.ttrpgsFolder);
    if (ttrpgsFolder instanceof import_obsidian.TFolder) {
      const campaigns = ttrpgsFolder.children.filter((file) => file instanceof import_obsidian.TFolder);
      campaigns.forEach((campaign) => {
        const option = campaignSelect.createEl("option");
        option.value = campaign.name;
        option.text = campaign.name;
      });
      campaignSelect.addEventListener("change", async () => {
        const selectedCampaign = campaignSelect.value;
        const campaignFolder = this.app.vault.getAbstractFileByPath(`ttrpgs/${selectedCampaign}`);
        if (campaignFolder instanceof import_obsidian.TFolder) {
          const sessionFiles = campaignFolder.children.filter((file) => file instanceof import_obsidian.TFile);
          const sessionNums = [];
          let mostRecentSessionFile;
          let maxSessionNum = 0;
          for (const file of sessionFiles) {
            const cache = this.app.metadataCache.getFileCache(file);
            if (cache && cache.frontmatter && cache.frontmatter.sessionNum) {
              const sessionNum = Number(cache.frontmatter.sessionNum);
              sessionNums.push(sessionNum);
              if (sessionNum > maxSessionNum) {
                maxSessionNum = sessionNum;
                mostRecentSessionFile = file;
              }
            }
          }
          const nextSessionNum = (maxSessionNum + 1).toString().padStart(2, "0");
          sessionNumInput.value = nextSessionNum;
          if (mostRecentSessionFile) {
            const cache = this.app.metadataCache.getFileCache(mostRecentSessionFile);
            const frontmatterKeys = ["world", "thread", "chapter", "location", "fc-date", "fc-category"];
            const inputFields = [worldInput, threadInput, chapterInput, locationInput, fcDateInput, fcCategoryInput];
            if (cache) {
              frontmatterKeys.forEach((key, index) => {
                if (cache.frontmatter) {
                  const value = key === "fc-date" && cache.frontmatter["fc-end"] ? cache.frontmatter["fc-end"] : cache.frontmatter[key];
                  inputFields[index].value = value || "";
                }
              });
            } else {
              console.error("Cache is undefined for the most recent session file.");
            }
          }
        }
      });
    }
    const dateDiv = form.createEl("div");
    dateDiv.style.marginBottom = "10px";
    dateDiv.createEl("label", { text: "Date: " });
    const dateInput = dateDiv.createEl("input");
    dateInput.type = "date";
    dateInput.valueAsDate = new Date();
    const submitButton = form.createEl("button");
    submitButton.type = "submit";
    submitButton.textContent = "Create Session";
    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      const selectedCampaign = campaignSelect.value;
      const campaignFolder = this.app.vault.getAbstractFileByPath(`ttrpgs/${selectedCampaign}`);
      const nextSessionNum = sessionNumInput.value.toString().padStart(3, "0");
      const sessionTitle = sessionTitleInput.value;
      const date = new Date(dateInput.value);
      const selectedDate = dateInput.value;
      const year = date.getFullYear();
      const month = (date.getMonth() + 1).toString().padStart(2, "0");
      const day = date.getDate().toString().padStart(2, "0");
      const formattedDate = `${year}${month}${day}`;
      if (campaignFolder instanceof import_obsidian.TFolder) {
        const templateFile = this.app.vault.getAbstractFileByPath(this.plugin.settings.sessionTemplate);
        console.log("Template File: ", this.plugin.settings.sessionTemplate);
        if (templateFile instanceof import_obsidian.TFile) {
          let templateContent = await this.app.vault.read(templateFile);
          const templateVariables = {
            "{{campaign}}": selectedCampaign,
            "{{sessionNum}}": nextSessionNum,
            "{{date}}": selectedDate,
            "{{world}}": worldInput.value,
            "{{thread}}": threadInput.value,
            "{{chapter}}": chapterInput.value,
            "{{location}}": locationInput.value,
            "{{fc-date}}": fcDateInput.value,
            "{{fc-category}}": fcCategoryInput.value
          };
          for (const key in templateVariables) {
            templateContent = templateContent.replace(new RegExp(key, "g"), templateVariables[key]);
          }
          const newNotePath = `ttrpgs/${selectedCampaign}/${nextSessionNum}_${formattedDate} - ${sessionTitle}.md`;
          const newNoteFile = await this.app.vault.create(newNotePath, templateContent);
          const leaf = app.workspace.getLeaf(true);
          leaf.openFile(newNoteFile);
          this.close();
        }
      }
    });
  }
};

// CreateSessionSettings.ts
var import_obsidian2 = require("obsidian");
var CreateSessionSettingsTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Session Template").setDesc("The note to use as a template for new sessions").addDropdown(async (dropdown) => {
      const templatesFolder = this.app.vault.getAbstractFileByPath("templates");
      if (templatesFolder instanceof import_obsidian2.TFolder) {
        const templates = templatesFolder.children.filter((file) => file instanceof import_obsidian2.TFile);
        templates.forEach((template) => {
          dropdown.addOption(template.path, template.name);
        });
        dropdown.setValue(this.plugin.settings.sessionTemplate);
        dropdown.onChange(async (value) => {
          console.log("Template selected:", value);
          this.plugin.settings.sessionTemplate = value;
          await this.plugin.saveSettings();
          console.log("Settings saved:", this.plugin.settings);
        });
      }
    });
    new import_obsidian2.Setting(containerEl).setName("Campaigns Folder").setDesc("The Folder Contianing the Campaign Folder(s) for Sessions").addDropdown(async (dropdown) => {
      const ttrpgsFolder = this.app.vault.getFolderByPath("ttrpgs");
      const rootFolder = this.app.vault.getFolderByPath("/");
      console.log("TTRPGS selected:", ttrpgsFolder);
      console.log("Folder selected:", rootFolder);
      if (ttrpgsFolder !== null) {
      } else {
      }
      if (rootFolder instanceof import_obsidian2.TFolder) {
        const folders = rootFolder.children.filter((folder) => folder instanceof import_obsidian2.TFolder);
        folders.forEach((folder) => {
          dropdown.addOption(folder.path, folder.name);
        });
        dropdown.setValue(this.plugin.settings.ttrpgsFolder);
        dropdown.onChange(async (value) => {
          console.log("Folder selected:", value);
          this.plugin.settings.ttrpgsFolder = value;
          await this.plugin.saveSettings();
          console.log("Settings saved:", this.plugin.settings);
          console.log("Settings saved:", this.plugin.settings);
        });
      }
    });
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  sessionTemplate: "",
  ttrpgsFolder: ""
};
var CreateSessionPlugin = class extends import_obsidian3.Plugin {
  async onload() {
    await this.loadSettings();
    const ribbonIconEl = this.addRibbonIcon("dice", "Create Session", (evt) => {
      new CreateSessionModal(this.app, this).open();
    });
    ribbonIconEl.addClass("my-plugin-ribbon-class");
    this.addSettingTab(new CreateSessionSettingsTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJDcmVhdGVTZXNzaW9uTW9kYWwudHMiLCAiQ3JlYXRlU2Vzc2lvblNldHRpbmdzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBDb25zb2xlIH0gZnJvbSAnY29uc29sZSc7XHJcbmltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBDcmVhdGVTZXNzaW9uTW9kYWwgZnJvbSAnLi9DcmVhdGVTZXNzaW9uTW9kYWwnO1xyXG5pbXBvcnQgQ3JlYXRlU2Vzc2lvblNldHRpbmdzVGFiIGZyb20gJy4vQ3JlYXRlU2Vzc2lvblNldHRpbmdzJztcclxuXG5pbnRlcmZhY2UgQ3JlYXRlU2Vzc2lvblBsdWdpblNldHRpbmdzIHtcblx0c2Vzc2lvblRlbXBsYXRlOiBzdHJpbmcsXG5cdHR0cnBnc0ZvbGRlcjogc3RyaW5nLFxyXG59XHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IENyZWF0ZVNlc3Npb25QbHVnaW5TZXR0aW5ncyA9IHtcclxuXHRzZXNzaW9uVGVtcGxhdGU6ICcnLFxuXHR0dHJwZ3NGb2xkZXI6ICcnLFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDcmVhdGVTZXNzaW9uUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogQ3JlYXRlU2Vzc2lvblBsdWdpblNldHRpbmdzO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuXHRcdC8vIFRoaXMgY3JlYXRlcyBhbiBpY29uIGluIHRoZSBsZWZ0IHJpYmJvbi5cclxuXHRcdGNvbnN0IHJpYmJvbkljb25FbCA9IHRoaXMuYWRkUmliYm9uSWNvbignZGljZScsICdDcmVhdGUgU2Vzc2lvbicsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0bmV3IENyZWF0ZVNlc3Npb25Nb2RhbCh0aGlzLmFwcCwgdGhpcykub3BlbigpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmliYm9uSWNvbkVsLmFkZENsYXNzKCdteS1wbHVnaW4tcmliYm9uLWNsYXNzJyk7XHJcblx0XHQvLyBBZGQgdGhlIHNldHRpbmdzIHRhYlxyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBDcmVhdGVTZXNzaW9uU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHRcdFxyXG5cdH1cclxuXHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcbn1cclxuXHJcblxyXG4iLCAiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzICovXHJcbi8vaW1wb3J0IHsgQ29uc29sZSB9IGZyb20gJ2NvbnNvbGUnO1xuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBURmlsZSwgVEZvbGRlciwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBDcmVhdGVTZXNzaW9uUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgQ3JlYXRlU2Vzc2lvblNldHRpbmdzVGFiIGZyb20gJy4vQ3JlYXRlU2Vzc2lvblNldHRpbmdzJztcbi8vaW1wb3J0IHsgcGFyc2VGcm9udE1hdHRlckVudHJ5LCBwYXJzZUZyb250TWF0dGVyIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgcGFyc2VGcm9udE1hdHRlckVudHJ5fSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENyZWF0ZVNlc3Npb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcblx0cGx1Z2luOiBDcmVhdGVTZXNzaW9uUGx1Z2luO1xuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDcmVhdGVTZXNzaW9uUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGNyZWF0ZUlucHV0RGl2KGZvcm06IEhUTUxFbGVtZW50LCBsYWJlbFRleHQ6IHN0cmluZywgaW5wdXRUeXBlID0gJ3RleHQnKTogSFRNTElucHV0RWxlbWVudCB7XG5cdFx0Y29uc3QgZGl2ID0gZm9ybS5jcmVhdGVFbCgnZGl2Jyk7XG5cdFx0ZGl2LnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcxMHB4JzsgIC8vIEFkZCBzb21lIHNwYWNlIGF0IHRoZSBib3R0b21cblx0XHRkaXYuY3JlYXRlRWwoJ2xhYmVsJywgeyB0ZXh0OiBsYWJlbFRleHQgfSk7XG5cdFx0Y29uc3QgaW5wdXQgPSBkaXYuY3JlYXRlRWwoJ2lucHV0Jyk7XG5cdFx0aW5wdXQudHlwZSA9IGlucHV0VHlwZTtcblx0XHRyZXR1cm4gaW5wdXQ7XG5cdH1cblxuXG5cdG9uT3BlbigpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb25zdCBmb3JtID0gY29udGVudEVsLmNyZWF0ZUVsKCdmb3JtJyk7XG5cblxuXHRcdC8vIENyZWF0ZSBhIGRpdiBmb3IgdGhlIGNhbXBhaWduIHNlbGVjdFxuXHRcdGNvbnN0IGNhbXBhaWduRGl2ID0gZm9ybS5jcmVhdGVFbCgnZGl2Jyk7XG5cdFx0Y2FtcGFpZ25EaXYuc3R5bGUubWFyZ2luQm90dG9tID0gJzEwcHgnOyAgLy8gQWRkIHNvbWUgc3BhY2UgYXQgdGhlIGJvdHRvbVxuXHRcdGNhbXBhaWduRGl2LmNyZWF0ZUVsKCdsYWJlbCcsIHsgdGV4dDogJ0NhbXBhaWduOiAnIH0pO1xuXHRcdGNvbnN0IGNhbXBhaWduU2VsZWN0ID0gY2FtcGFpZ25EaXYuY3JlYXRlRWwoJ3NlbGVjdCcpO1xuXG5cdFx0Ly8gQWRkIGEgXCJTRUxFQ1QgQ0FNUEFJR05cIiBvcHRpb25cblx0XHRjb25zdCBzZWxlY3RDYW1wYWlnbk9wdGlvbiA9IGNhbXBhaWduU2VsZWN0LmNyZWF0ZUVsKCdvcHRpb24nKTtcblx0XHRzZWxlY3RDYW1wYWlnbk9wdGlvbi52YWx1ZSA9ICcnO1xuXHRcdHNlbGVjdENhbXBhaWduT3B0aW9uLnRleHQgPSAnU0VMRUNUIENBTVBBSUdOJztcblx0XHRzZWxlY3RDYW1wYWlnbk9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG5cdFx0c2VsZWN0Q2FtcGFpZ25PcHRpb24uZGlzYWJsZWQgPSB0cnVlO1xuXG5cdFx0Ly8gQ3JlYXRlIGEgZGl2IGZvciB0aGUgc2Vzc2lvbiBudW1iZXIgaW5wdXRcblx0XHRjb25zdCBzZXNzaW9uTnVtSW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0RGl2KGZvcm0sICdTZXNzaW9uIE51bWJlcjogJyk7XG5cblx0XHQvLyBDcmVhdGUgYSBkaXYgZm9yIHRoZSBzZXNzaW9uIHRpdGxlIGlucHV0XG5cdFx0Y29uc3Qgc2Vzc2lvblRpdGxlSW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0RGl2KGZvcm0sICdTZXNzaW9uIFRpdGxlOiAnKTtcblxuXHRcdC8vIENyZWF0ZSBhIGRpdiBmb3IgdGhlIHdvcmxkIGlucHV0XG5cdFx0Y29uc3Qgd29ybGRJbnB1dCA9IHRoaXMuY3JlYXRlSW5wdXREaXYoZm9ybSwgJ1dvcmxkOiAnKTtcblxuXHRcdC8vIENyZWF0ZSBhIGRpdiBmb3IgdGhlIHRocmVhZCBpbnB1dFxuXHRcdGNvbnN0IHRocmVhZElucHV0ID0gdGhpcy5jcmVhdGVJbnB1dERpdihmb3JtLCAnVGhyZWFkOiAnKTtcblxuXHRcdC8vIENyZWF0ZSBhIGRpdiBmb3IgdGhlIGNoYXB0ZXIgaW5wdXRcblx0XHRjb25zdCBjaGFwdGVySW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0RGl2KGZvcm0sICdDaGFwdGVyOiAnKTtcblxuXHRcdC8vIENyZWF0ZSBhIGRpdiBmb3IgdGhlIGxvY2F0aW9uIGlucHV0XG5cdFx0Y29uc3QgbG9jYXRpb25JbnB1dCA9IHRoaXMuY3JlYXRlSW5wdXREaXYoZm9ybSwgJ0xvY2F0aW9uOiAnKTtcblxuXHRcdC8vIENyZWF0ZSBhIGRpdiBmb3IgdGhlIGZjLWRhdGUgaW5wdXRcblx0XHRjb25zdCBmY0RhdGVJbnB1dCA9IHRoaXMuY3JlYXRlSW5wdXREaXYoZm9ybSwgJ0ZjLWRhdGU6ICcpO1xuXG5cdFx0Ly8gQ3JlYXRlIGEgZGl2IGZvciB0aGUgZmMtY2F0ZWdvcnkgaW5wdXRcblx0XHRjb25zdCBmY0NhdGVnb3J5SW5wdXQgPSB0aGlzLmNyZWF0ZUlucHV0RGl2KGZvcm0sICdGYy1jYXRlZ29yeTogJyk7XG5cblxuXHRcdC8vIEdldCB0aGUgJ3R0cnBncycgZm9sZGVyXG5cdFx0Y29uc3QgdHRycGdzRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMucGx1Z2luLnNldHRpbmdzLnR0cnBnc0ZvbGRlcik7XG5cdFx0Ly8gY29uc3QgdHRycGdzRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKCd0dHJwZ3MnKTtcblxuXHRcdGlmICh0dHJwZ3NGb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG5cdFx0XHQvLyBHZXQgdGhlIHN1YmZvbGRlcnMgKGNhbXBhaWducylcblx0XHRcdGNvbnN0IGNhbXBhaWducyA9IHR0cnBnc0ZvbGRlci5jaGlsZHJlbi5maWx0ZXIoZmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZvbGRlcik7XG5cblx0XHRcdC8vIFBvcHVsYXRlIHRoZSBjYW1wYWlnblNlbGVjdCBkcm9wZG93biB3aXRoIHRoZSBjYW1wYWlnbiBuYW1lc1xuXHRcdFx0Y2FtcGFpZ25zLmZvckVhY2goY2FtcGFpZ24gPT4ge1xuXHRcdFx0XHRjb25zdCBvcHRpb24gPSBjYW1wYWlnblNlbGVjdC5jcmVhdGVFbCgnb3B0aW9uJyk7XG5cdFx0XHRcdG9wdGlvbi52YWx1ZSA9IGNhbXBhaWduLm5hbWU7XG5cdFx0XHRcdG9wdGlvbi50ZXh0ID0gY2FtcGFpZ24ubmFtZTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBXaGVuIGEgY2FtcGFpZ24gaXMgc2VsZWN0ZWQsIGNhbGN1bGF0ZSB0aGUgIG5leHQgc2Vzc2lvbiBudW1iZXIgYW5kIGV4dHJhY3Qgb3RoZXIgc2Vzc2lvbiBpbmZvIGZyb20gcGVydmlvdXMgc2Vzc2lvbiBmcm9udG1hdHRlclxuXHRcdFx0Y2FtcGFpZ25TZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBzZWxlY3RlZENhbXBhaWduID0gY2FtcGFpZ25TZWxlY3QudmFsdWU7XG5cdFx0XHRcdGNvbnN0IGNhbXBhaWduRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGB0dHJwZ3MvJHtzZWxlY3RlZENhbXBhaWdufWApO1xuXG5cdFx0XHRcdGlmIChjYW1wYWlnbkZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdFx0XHRjb25zdCBzZXNzaW9uRmlsZXMgPSBjYW1wYWlnbkZvbGRlci5jaGlsZHJlbi5maWx0ZXIoZmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuXHRcdFx0XHRcdGNvbnN0IHNlc3Npb25OdW1zID0gW107XG5cdFx0XHRcdFx0bGV0IG1vc3RSZWNlbnRTZXNzaW9uRmlsZTtcblx0XHRcdFx0XHRsZXQgbWF4U2Vzc2lvbk51bSA9IDA7XG5cblx0XHRcdFx0XHRmb3IgKGNvbnN0IGZpbGUgb2Ygc2Vzc2lvbkZpbGVzKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUgYXMgVEZpbGUpO1xuXHRcdFx0XHRcdFx0aWYgKGNhY2hlICYmIGNhY2hlLmZyb250bWF0dGVyICYmIGNhY2hlLmZyb250bWF0dGVyLnNlc3Npb25OdW0pIHtcblx0XHRcdFx0XHRcdFx0Y29uc3Qgc2Vzc2lvbk51bSA9IE51bWJlcihjYWNoZS5mcm9udG1hdHRlci5zZXNzaW9uTnVtKTtcblx0XHRcdFx0XHRcdFx0c2Vzc2lvbk51bXMucHVzaChzZXNzaW9uTnVtKTtcblx0XHRcdFx0XHRcdFx0aWYgKHNlc3Npb25OdW0gPiBtYXhTZXNzaW9uTnVtKSB7XG5cdFx0XHRcdFx0XHRcdFx0bWF4U2Vzc2lvbk51bSA9IHNlc3Npb25OdW07XG5cdFx0XHRcdFx0XHRcdFx0bW9zdFJlY2VudFNlc3Npb25GaWxlID0gZmlsZSBhcyBURmlsZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGNvbnN0IG5leHRTZXNzaW9uTnVtID0gKG1heFNlc3Npb25OdW0gKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7XG5cdFx0XHRcdFx0c2Vzc2lvbk51bUlucHV0LnZhbHVlID0gbmV4dFNlc3Npb25OdW07XG5cblx0XHRcdFx0XHRpZiAobW9zdFJlY2VudFNlc3Npb25GaWxlKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKG1vc3RSZWNlbnRTZXNzaW9uRmlsZSk7XG5cdFx0XHRcdFx0XHRjb25zdCBmcm9udG1hdHRlcktleXMgPSBbJ3dvcmxkJywgJ3RocmVhZCcsICdjaGFwdGVyJywgJ2xvY2F0aW9uJywgJ2ZjLWRhdGUnLCAnZmMtY2F0ZWdvcnknXTtcblx0XHRcdFx0XHRcdGNvbnN0IGlucHV0RmllbGRzID0gW3dvcmxkSW5wdXQsIHRocmVhZElucHV0LCBjaGFwdGVySW5wdXQsIGxvY2F0aW9uSW5wdXQsIGZjRGF0ZUlucHV0LCBmY0NhdGVnb3J5SW5wdXRdO1xuXHRcdFx0XHRcdFx0aWYgKGNhY2hlKSB7XG5cdFx0XHRcdFx0XHRcdGZyb250bWF0dGVyS2V5cy5mb3JFYWNoKChrZXksIGluZGV4KSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNhY2hlLmZyb250bWF0dGVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IGtleSA9PT0gJ2ZjLWRhdGUnICYmIGNhY2hlLmZyb250bWF0dGVyWydmYy1lbmQnXSA/IGNhY2hlLmZyb250bWF0dGVyWydmYy1lbmQnXSA6IGNhY2hlLmZyb250bWF0dGVyW2tleV07XG5cdFx0XHRcdFx0XHRcdFx0XHRpbnB1dEZpZWxkc1tpbmRleF0udmFsdWUgPSB2YWx1ZSB8fCAnJztcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcignQ2FjaGUgaXMgdW5kZWZpbmVkIGZvciB0aGUgbW9zdCByZWNlbnQgc2Vzc2lvbiBmaWxlLicpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHR9XG5cblx0XHQvLyBDcmVhdGUgYSBkaXYgZm9yIHRoZSBkYXRlIGlucHV0XG5cdFx0Y29uc3QgZGF0ZURpdiA9IGZvcm0uY3JlYXRlRWwoJ2RpdicpO1xuXHRcdGRhdGVEaXYuc3R5bGUubWFyZ2luQm90dG9tID0gJzEwcHgnOyAgLy8gQWRkIHNvbWUgc3BhY2UgYXQgdGhlIGJvdHRvbVxuXG5cdFx0ZGF0ZURpdi5jcmVhdGVFbCgnbGFiZWwnLCB7IHRleHQ6ICdEYXRlOiAnIH0pO1xuXHRcdGNvbnN0IGRhdGVJbnB1dCA9IGRhdGVEaXYuY3JlYXRlRWwoJ2lucHV0Jyk7XG5cdFx0ZGF0ZUlucHV0LnR5cGUgPSAnZGF0ZSc7XG5cdFx0ZGF0ZUlucHV0LnZhbHVlQXNEYXRlID0gbmV3IERhdGUoKTsgIC8vIERlZmF1bHQgdG8gdG9kYXkncyBkYXRlXG5cblx0XHQvLyBBZGQgYSBzdWJtaXQgYnV0dG9uXG5cdFx0Y29uc3Qgc3VibWl0QnV0dG9uID0gZm9ybS5jcmVhdGVFbCgnYnV0dG9uJyk7XG5cdFx0c3VibWl0QnV0dG9uLnR5cGUgPSAnc3VibWl0Jztcblx0XHRzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnQ3JlYXRlIFNlc3Npb24nO1xuXG5cdFx0Ly8gV2hlbiB0aGUgZm9ybSBpcyBzdWJtaXR0ZWQsIGNyZWF0ZSBhIG5ldyBub3RlXG5cdFx0Zm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBhc3luYyAoZXZlbnQpID0+IHtcblx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdGNvbnN0IHNlbGVjdGVkQ2FtcGFpZ24gPSBjYW1wYWlnblNlbGVjdC52YWx1ZTtcblxuXHRcdFx0Y29uc3QgY2FtcGFpZ25Gb2xkZXIgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYHR0cnBncy8ke3NlbGVjdGVkQ2FtcGFpZ259YCk7XG5cdFx0XHRjb25zdCBuZXh0U2Vzc2lvbk51bSA9IHNlc3Npb25OdW1JbnB1dC52YWx1ZS50b1N0cmluZygpLnBhZFN0YXJ0KDMsICcwJyk7XG5cdFx0XHRjb25zdCBzZXNzaW9uVGl0bGUgPSBzZXNzaW9uVGl0bGVJbnB1dC52YWx1ZTtcblxuXHRcdFx0Y29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhdGVJbnB1dC52YWx1ZSk7XG5cdFx0XHRjb25zdCBzZWxlY3RlZERhdGUgPSBkYXRlSW5wdXQudmFsdWU7XG5cdFx0XHRjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuXHRcdFx0Y29uc3QgbW9udGggPSAoZGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOyAgLy8gTW9udGhzIGFyZSAwLWJhc2VkIGluIEphdmFTY3JpcHRcblx0XHRcdGNvbnN0IGRheSA9IGRhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTtcblx0XHRcdGNvbnN0IGZvcm1hdHRlZERhdGUgPSBgJHt5ZWFyfSR7bW9udGh9JHtkYXl9YDtcblxuXHRcdFx0aWYgKGNhbXBhaWduRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHQvLyBHZXQgdGhlIHRlbXBsYXRlIGZpbGVcblx0XHRcdFx0Y29uc3QgdGVtcGxhdGVGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlc3Npb25UZW1wbGF0ZSk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdUZW1wbGF0ZSBGaWxlOiAnLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uVGVtcGxhdGUpO1xuXG5cdFx0XHRcdGlmICh0ZW1wbGF0ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdGxldCB0ZW1wbGF0ZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRlbXBsYXRlRmlsZSk7XG5cblx0XHRcdFx0XHQvLyBSZXBsYWNlIHRlbXBsYXRlIHZhcmlhYmxlcyBpbiB0ZW1wbGF0ZUNvbnRlbnQuLi5cblx0XHRcdFx0XHRjb25zdCB0ZW1wbGF0ZVZhcmlhYmxlczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcblx0XHRcdFx0XHRcdCd7e2NhbXBhaWdufX0nOiBzZWxlY3RlZENhbXBhaWduLFxuXHRcdFx0XHRcdFx0J3t7c2Vzc2lvbk51bX19JzogbmV4dFNlc3Npb25OdW0sXG5cdFx0XHRcdFx0XHQne3tkYXRlfX0nOiBzZWxlY3RlZERhdGUsXG5cdFx0XHRcdFx0XHQne3t3b3JsZH19Jzogd29ybGRJbnB1dC52YWx1ZSxcblx0XHRcdFx0XHRcdCd7e3RocmVhZH19JzogdGhyZWFkSW5wdXQudmFsdWUsXG5cdFx0XHRcdFx0XHQne3tjaGFwdGVyfX0nOiBjaGFwdGVySW5wdXQudmFsdWUsXG5cdFx0XHRcdFx0XHQne3tsb2NhdGlvbn19JzogbG9jYXRpb25JbnB1dC52YWx1ZSxcblx0XHRcdFx0XHRcdCd7e2ZjLWRhdGV9fSc6IGZjRGF0ZUlucHV0LnZhbHVlLFxuXHRcdFx0XHRcdFx0J3t7ZmMtY2F0ZWdvcnl9fSc6IGZjQ2F0ZWdvcnlJbnB1dC52YWx1ZVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRmb3IgKGNvbnN0IGtleSBpbiB0ZW1wbGF0ZVZhcmlhYmxlcykge1xuXHRcdFx0XHRcdFx0dGVtcGxhdGVDb250ZW50ID0gdGVtcGxhdGVDb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChrZXksICdnJyksIHRlbXBsYXRlVmFyaWFibGVzW2tleV0pO1xuXHRcdFx0XHRcdH1cblxuXG5cblxuXHRcdFx0XHRcdGNvbnN0IG5ld05vdGVQYXRoID0gYHR0cnBncy8ke3NlbGVjdGVkQ2FtcGFpZ259LyR7bmV4dFNlc3Npb25OdW19XyR7Zm9ybWF0dGVkRGF0ZX0gLSAke3Nlc3Npb25UaXRsZX0ubWRgO1xuXHRcdFx0XHRcdGNvbnN0IG5ld05vdGVGaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKG5ld05vdGVQYXRoLCB0ZW1wbGF0ZUNvbnRlbnQpO1xuXHRcdFx0XHRcdC8vYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLm9wZW5Ob3RlKG5ld05vdGVGaWxlKTtcblx0XHRcdFx0XHRjb25zdCBsZWFmID0gYXBwLndvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xuXHRcdFx0XHRcdGxlYWYub3BlbkZpbGUobmV3Tm90ZUZpbGUpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxufVxuXG5mdW5jdGlvbiBnZXRMZWFmV2l0aE5vdGUoYXBwOiBBcHAsIGZpbGU6IFRGaWxlKTogdW5kZWZpbmVkIHwgV29ya3NwYWNlTGVhZiB7XG5cdGxldCBvcGVuZWRMZWFmOiBXb3Jrc3BhY2VMZWFmIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXHRhcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMoKGxlYWYpID0+IHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgbGVhZkZpbGUgPSBsZWFmLnZpZXcuZmlsZSBhcyBURmlsZTtcblx0XHRpZiAobGVhZkZpbGU/LnBhdGggPT09IGZpbGUucGF0aCkge1xuXHRcdFx0b3BlbmVkTGVhZiA9IGxlYWY7XG5cdFx0fVxuXHR9KTtcblx0cmV0dXJuIG9wZW5lZExlYWY7XG59XG4iLCAiLy9pbXBvcnQgeyBDb25zb2xlIH0gZnJvbSAnY29uc29sZSc7XHJcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBDcmVhdGVTZXNzaW9uUGx1Z2luIGZyb20gJy4vbWFpbic7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ3JlYXRlU2Vzc2lvblNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBDcmVhdGVTZXNzaW9uUGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDcmVhdGVTZXNzaW9uUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdTZXNzaW9uIFRlbXBsYXRlJylcclxuXHRcdFx0LnNldERlc2MoJ1RoZSBub3RlIHRvIHVzZSBhcyBhIHRlbXBsYXRlIGZvciBuZXcgc2Vzc2lvbnMnKVxyXG5cdFx0XHQuYWRkRHJvcGRvd24oYXN5bmMgZHJvcGRvd24gPT4ge1xyXG5cdFx0XHRcdC8vIEdldCB0aGUgJ3RlbXBsYXRlcycgZm9sZGVyXHJcblx0XHRcdFx0Y29uc3QgdGVtcGxhdGVzRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKCd0ZW1wbGF0ZXMnKTtcclxuXHJcblx0XHRcdFx0aWYgKHRlbXBsYXRlc0ZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcclxuXHRcdFx0XHRcdC8vIEdldCB0aGUgZmlsZXMgaW4gdGhlICd0ZW1wbGF0ZXMnIGZvbGRlclxyXG5cdFx0XHRcdFx0Y29uc3QgdGVtcGxhdGVzID0gdGVtcGxhdGVzRm9sZGVyLmNoaWxkcmVuLmZpbHRlcihmaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gUG9wdWxhdGUgdGhlIGRyb3Bkb3duIHdpdGggdGhlIHRlbXBsYXRlIG5hbWVzXHJcblx0XHRcdFx0XHR0ZW1wbGF0ZXMuZm9yRWFjaCh0ZW1wbGF0ZSA9PiB7XHJcblx0XHRcdFx0XHRcdGRyb3Bkb3duLmFkZE9wdGlvbih0ZW1wbGF0ZS5wYXRoLCB0ZW1wbGF0ZS5uYW1lKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdC8vIFNldCB0aGUgdmFsdWUgb2YgdGhlIGRyb3Bkb3duIHRvIHRoZSBjdXJyZW50IHRlbXBsYXRlXHJcblx0XHRcdFx0XHRkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uVGVtcGxhdGUpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFdoZW4gYSB0ZW1wbGF0ZSBpcyBzZWxlY3RlZCwgc2F2ZSBpdCB0byB0aGUgc2V0dGluZ3NcclxuXHRcdFx0XHRcdGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnVGVtcGxhdGUgc2VsZWN0ZWQ6JywgdmFsdWUpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZXNzaW9uVGVtcGxhdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdTZXR0aW5ncyBzYXZlZDonLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKCdDYW1wYWlnbnMgRm9sZGVyJylcclxuXHRcdFx0LnNldERlc2MoJ1RoZSBGb2xkZXIgQ29udGlhbmluZyB0aGUgQ2FtcGFpZ24gRm9sZGVyKHMpIGZvciBTZXNzaW9ucycpXHJcblx0XHRcdC5hZGREcm9wZG93bihhc3luYyBkcm9wZG93biA9PiB7XHJcblx0XHRcdFx0Ly8gR2V0IHRoZSAndHRycGdzJyBmb2xkZXJcclxuXHRcdFx0XHRjb25zdCB0dHJwZ3NGb2xkZXIgPSB0aGlzLmFwcC52YXVsdC5nZXRGb2xkZXJCeVBhdGgoJ3R0cnBncycpO1xuXHRcdFx0XHQvLyBjb25zdCByb290Rm9sZGVyID0gdGhpcy5hcHAudmF1bHQuYWRhcHRlci5iYXNlUGF0aDtcblx0XHRcdFx0Y29uc3Qgcm9vdEZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEZvbGRlckJ5UGF0aCgnLycpO1xuXHRcdFx0XHRjb25zb2xlLmxvZygnVFRSUEdTIHNlbGVjdGVkOicsIHR0cnBnc0ZvbGRlcik7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdGb2xkZXIgc2VsZWN0ZWQ6Jywgcm9vdEZvbGRlcik7XG5cdFx0XHRcdGlmICh0dHJwZ3NGb2xkZXIgIT09IG51bGwpIHtcblx0XHRcdFx0XHQvLyB0dHJwZ3NGb2xkZXIgaXMgbm90IG51bGwsIGRvIHNvbWV0aGluZy4uLlxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIHR0cnBnc0ZvbGRlciBpcyBudWxsLCBoYW5kbGUgdGhlIG51bGwgY2FzZS4uLlxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGlmIChyb290Rm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xyXG5cdFx0XHRcdFx0Ly8gR2V0IHRoZSBmaWxlcyBpbiB0aGUgJ3RlbXBsYXRlcycgZm9sZGVyXHJcblx0XHRcdFx0XHRjb25zdCBmb2xkZXJzID0gcm9vdEZvbGRlci5jaGlsZHJlbi5maWx0ZXIoZm9sZGVyID0+IGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFBvcHVsYXRlIHRoZSBkcm9wZG93biB3aXRoIHRoZSBjaGlsZCBmb2xkZXJzXHJcblx0XHRcdFx0XHRmb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcclxuXHRcdFx0XHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKGZvbGRlci5wYXRoLCBmb2xkZXIubmFtZSk7XHJcblx0XHRcdFx0XHR9KTtcblxyXG5cclxuXHRcdFx0XHRcdC8vIFNldCB0aGUgdmFsdWUgb2YgdGhlIGRyb3Bkb3duIHRvIHRoZSBjdXJyZW50IHRlbXBsYXRlXHJcblx0XHRcdFx0XHRkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50dHJwZ3NGb2xkZXIpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFdoZW4gYSB0ZW1wbGF0ZSBpcyBzZWxlY3RlZCwgc2F2ZSBpdCB0byB0aGUgc2V0dGluZ3NcclxuXHRcdFx0XHRcdGRyb3Bkb3duLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnRm9sZGVyIHNlbGVjdGVkOicsIHZhbHVlKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MudHRycGdzRm9sZGVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnU2V0dGluZ3Mgc2F2ZWQ6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xuXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygnU2V0dGluZ3Mgc2F2ZWQ6JywgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblxyXG5cdH1cclxuXHJcblxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQSxJQUFBQSxtQkFBNEc7OztBQ0M1RyxzQkFBMkg7QUFNM0gsSUFBcUIscUJBQXJCLGNBQWdELHNCQUFNO0FBQUEsRUFFckQsWUFBWUMsTUFBVSxRQUE2QjtBQUNsRCxVQUFNQSxJQUFHO0FBQ1QsU0FBSyxTQUFTO0FBQUEsRUFDZjtBQUFBLEVBRUEsZUFBZSxNQUFtQixXQUFtQixZQUFZLFFBQTBCO0FBQzFGLFVBQU0sTUFBTSxLQUFLLFNBQVMsS0FBSztBQUMvQixRQUFJLE1BQU0sZUFBZTtBQUN6QixRQUFJLFNBQVMsU0FBUyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ3pDLFVBQU0sUUFBUSxJQUFJLFNBQVMsT0FBTztBQUNsQyxVQUFNLE9BQU87QUFDYixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBR0EsU0FBUztBQUNSLFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsVUFBTSxPQUFPLFVBQVUsU0FBUyxNQUFNO0FBSXRDLFVBQU0sY0FBYyxLQUFLLFNBQVMsS0FBSztBQUN2QyxnQkFBWSxNQUFNLGVBQWU7QUFDakMsZ0JBQVksU0FBUyxTQUFTLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDcEQsVUFBTSxpQkFBaUIsWUFBWSxTQUFTLFFBQVE7QUFHcEQsVUFBTSx1QkFBdUIsZUFBZSxTQUFTLFFBQVE7QUFDN0QseUJBQXFCLFFBQVE7QUFDN0IseUJBQXFCLE9BQU87QUFDNUIseUJBQXFCLFdBQVc7QUFDaEMseUJBQXFCLFdBQVc7QUFHaEMsVUFBTSxrQkFBa0IsS0FBSyxlQUFlLE1BQU0sa0JBQWtCO0FBR3BFLFVBQU0sb0JBQW9CLEtBQUssZUFBZSxNQUFNLGlCQUFpQjtBQUdyRSxVQUFNLGFBQWEsS0FBSyxlQUFlLE1BQU0sU0FB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TSxhQUFZO0FBRTlCLFlBQU0sZUFBZSxLQUFLLElBQUksTUFBTSxnQkFBZ0IsUUFBUTtBQUU1RCxZQUFNLGFBQWEsS0FBSyxJQUFJLE1BQU0sZ0JBQWdCLEdBQUc7QUFDckQsY0FBUSxJQUFJLG9CQUFvQixZQUFZO0FBQzVDLGNBQVEsSUFBSSxvQkFBb0IsVUFBVTtBQUMxQyxVQUFJLGlCQUFpQixNQUFNO0FBQUEsTUFFM0IsT0FBTztBQUFBLE1BRVA7QUFFQSxVQUFJLHNCQUFzQiwwQkFBUztBQUVsQyxjQUFNLFVBQVUsV0FBVyxTQUFTLE9BQU8sWUFBVSxrQkFBa0Isd0JBQU87QUFHOUUsZ0JBQVEsUUFBUSxZQUFVO0FBQ3pCLG1CQUFTLFVBQVUsT0FBTyxNQUFNLE9BQU8sSUFBSTtBQUFBLFFBQzVDLENBQUM7QUFJRCxpQkFBUyxTQUFTLEtBQUssT0FBTyxTQUFTLFlBQVk7QUFHbkQsaUJBQVMsU0FBUyxPQUFPLFVBQVU7QUFDbEMsa0JBQVEsSUFBSSxvQkFBb0IsS0FBSztBQUNyQyxlQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLGdCQUFNLEtBQUssT0FBTyxhQUFhO0FBQy9CLGtCQUFRLElBQUksbUJBQW1CLEtBQUssT0FBTyxRQUFRO0FBRW5ELGtCQUFRLElBQUksbUJBQW1CLEtBQUssT0FBTyxRQUFRO0FBQUEsUUFDcEQsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNELENBQUM7QUFBQSxFQUdIO0FBR0Q7OztBRm5GQSxJQUFNLG1CQUFnRDtBQUFBLEVBQ3JELGlCQUFpQjtBQUFBLEVBQ2pCLGNBQWM7QUFDZjtBQUVBLElBQXFCLHNCQUFyQixjQUFpRCx3QkFBTztBQUFBLEVBR3ZELE1BQU0sU0FBUztBQUNkLFVBQU0sS0FBSyxhQUFhO0FBR3hCLFVBQU0sZUFBZSxLQUFLLGNBQWMsUUFBUSxrQkFBa0IsQ0FBQyxRQUFvQjtBQUN0RixVQUFJLG1CQUFtQixLQUFLLEtBQUssSUFBSSxFQUFFLEtBQUs7QUFBQSxJQUM3QyxDQUFDO0FBRUQsaUJBQWEsU0FBUyx3QkFBd0I7QUFFOUMsU0FBSyxjQUFjLElBQUkseUJBQXlCLEtBQUssS0FBSyxJQUFJLENBQUM7QUFBQSxFQUVoRTtBQUFBLEVBR0EsTUFBTSxlQUFlO0FBQ3BCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDMUU7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNwQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNsQztBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiYXBwIiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiXQp9Cg==
